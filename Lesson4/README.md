# Практическая работа №4
**Тема:** Привязка компонентов интерфейса, асинхронные процессы, сервисы и фоновые задачи с WorkManager в Android.  
**Цель:**
Освоить следующие техники:
- использование ViewBinding для связи элементов интерфейса с кодом;
- реализация многопоточной работы с помощью Thread, Handler, Looper, Loader;
- обмен информацией между потоками и обновление UI из фона;
- создание сервиса (Service) для воспроизведения аудио;
- выполнение фоновых задач через WorkManager.
## Основной проект
Был создан проект **ru.mirea.tenyutin.lesson4**, в котором реализован простой музыкальный плеер. Устройство корректно работает как в вертикальной, так и в горизонтальной ориентации. В качестве аудиотрека использован фрагмент из альбома *Miss* исполнительницы **Dora** *La Boheme*. Сам плеер был сверстан с применением современных средств компоновки и интерфейса.
![image](https://github.com/user-attachments/assets/20bb52f0-c9f1-45cc-9d9d-10613bd48be9)
![image](https://github.com/user-attachments/assets/908f10da-a317-4baf-ad86-3d92284b8ff0)
## Асинхронная работа: основы
В рамках модуля thread была реализована простая многопоточная структура.
Использование ViewBinding заменяет вызов findViewById, позволяет безопасно обращаться к компонентам и избавляет от NullPointerException.
Создание вторичных потоков через Thread позволяет выносить тяжёлые операции за пределы UI-потока.
Для взаимодействия с главным потоком использовался runOnUiThread(), который позволяет обновить интерфейс из фонового потока безопасно и корректно.
![image](https://github.com/user-attachments/assets/9acd0cc1-9c9a-48a4-b84c-af5fbef9a5f4)
![image](https://github.com/user-attachments/assets/b5ef8d39-9075-49ff-9d5a-308955b27404)
## Передача данных между потоками 
### Задание 3.1 – 3.3
В модуле data_thread реализован обмен информацией между потоками с применением Looper и Handler.
Была настроена очередь сообщений, в которой данные (вводимые пользователем возраст и профессия, в моем случае: 20 лет, стажер Альфа-Банк) передаются во второй поток, где выполняется задержка, соответствующая возрасту. После этого результат возвращается в основной поток и отображается в интерфейсе.
Также применялись методы:
- runOnUiThread(Runnable) — немедленное выполнение задачи в UI-потоке;
- View.post(Runnable) — добавление задачи в очередь сообщений;
- View.postDelayed(Runnable, delay) — запуск с задержкой.
![image](https://github.com/user-attachments/assets/dfea6f8f-8dc4-4c63-bba0-b22c45c1fe4c)
![image](https://github.com/user-attachments/assets/65cd2e73-21b9-4e55-aa49-3c723de990c8)
![image](https://github.com/user-attachments/assets/ef08f6f1-0cdb-4457-aac8-a4ee50057551)
## Loader и работа с шифрованием
В модуле CryptoLoader создан собственный загрузчик MyLoader, наследующий AsyncTaskLoader<String>.
В конструктор передавались Context и Bundle, содержащий зашифрованный текст и ключ.
Загрузка и дешифровка выполнялись в loadInBackground() с использованием утилит CryptoUtils.
![image](https://github.com/user-attachments/assets/cdb5ae67-2425-4f74-a33a-3dc4200bbdc3)
![image](https://github.com/user-attachments/assets/291c23fc-fd7a-4497-82f4-4b5b4d1a072f)
## Сервис и воспроизведение музыки
В модуле ServiceApp реализован компонент Service, работающий в фоновом режиме.
Сервис позволяет запускать аудиотрек в фоне, даже если пользователь покидает экран.
В интерфейсе отображается уведомление, информирующее о проигрывании.
Это пример foreground service, который корректно управляется системой и сохраняется при смене состояний активности.
![image](https://github.com/user-attachments/assets/1539d5ad-f168-4142-ad79-6b44f725d59f)
![image](https://github.com/user-attachments/assets/a0e7f962-4a12-47bc-a56a-3d51b19ee8ac)
## Работа с WorkManager
Модуль WorkManagerApp подключён через зависимости в build.gradle.
Создана одноразовая задача (OneTimeWorkRequest), демонстрирующая:
- выполнение действия в фоновом режиме;
- установку ограничений на выполнение (например, при наличии сети);
- отмену задачи, если условия не соблюдаются;
- автоматическое управление системой даже в режимах Doze и JobScheduler.
![image](https://github.com/user-attachments/assets/2005759b-f274-47e2-99c6-7400dddc289b)
![image](https://github.com/user-attachments/assets/30cb9c0c-a91b-4725-90c9-1b9249db90e9)
![image](https://github.com/user-attachments/assets/7bc135b6-b516-4ab0-8e5d-4c84a6c5b594)
![image](https://github.com/user-attachments/assets/92224671-d7e7-46b8-9eff-f523c10ca09b)
## Результаты работы
В результате выполнения практической части были освоены:
- технологии ViewBinding для привязки компонентов;
- принципы многопоточной архитектуры (Thread, Handler, Looper);
- создание взаимодействия между фоновыми и основными потоками;
- реализация пользовательского сервиса для проигрывания медиа;
- запуск и управление задачами с помощью WorkManager.
# Интеграция с MireaProject
В учебный проект **MireaProject** был добавлен новый компонент — WorkFragment, реализующий запуск фоновой задачи через WorkManager.
После нажатия на кнопку начинается выполнение работы в отдельном потоке с задержкой, а статус отображается прямо в интерфейсе.
Такой подход помогает организовать длительные или отложенные действия без нагрузки на основной процесс приложения.
![image](https://github.com/user-attachments/assets/daf32985-a49e-49ec-8142-4e657b9e484f)

---

**Работу выполнил**: Тенютин М.М  
**Группа**: БСБО-09-22








